<!doctype html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<meta name="viewport"
	      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.1.3/socket.io.min.js"></script>
</head>
<body>

	<script type="text/javascript">

		let socket = io('ws://localhost:3000', {
			transports: ["websocket"],
			path : '/'
		});

		socket.on('connect', function(){

			socket.on('on.user.authorized', function(data){

				socket.on('on.message.new', function(data){
					console.log(data);
				});

				socket.on('on.chat.history', function(data){
					console.log(data);
				})

				socket.emit('chat.history', {
					room_id : 1
				});

			});

			socket.emit('user.auth', {
				id : 2
			});

		});

		socket.on("connect_error", function(){
			alert('Error');
		});

	</script>

</body>
</html>